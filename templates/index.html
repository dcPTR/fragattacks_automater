<!DOCTYPE html>
<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.13.2/themes/base/jquery-ui.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js" integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.3.min.js" integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js" integrity="sha256-lSjKY0/srUM9BE3dPm+c4fBo1dky2v27Gdjm2uoZaL0=" crossorigin="anonymous"></script>
    <script src="/static/test.js"></script>
</head>
<body>
    <div class="container">
        <div id="header" class="container">
            <h1>FragTester</h1>
            <h2>
                <a href="/" class="btn btn-primary">
                        Main Page
                </a>
                <a href="/list" class="btn btn-info">
                        Test Results
                </a>
                <a href="/test" class="btn btn-info">
                        Perform Tests
                </a>
            </h2>
        </div>
        <hr>
        <div id="frontpage-container" class="container">
            <h1>Czym są FragAttacks</h1>

            <p>FragAttacks (z ang. fragmentation and aggregation attacks) są zbiorem ataków cyberprzestępczych niedawno odkrytych przez Mathy’ego Vanhoef’a, profesora Wydziału Informatyki Katolickiego Uniwersytetu Lowańskiego w Belgii i jego zespół badaczy. Ataki nazywają się tak, ponieważ wykorzystują luki w zabezpieczeniach urządzeń Wi-Fi dotyczące fragmentacji (dzielenie ramki na kilka mniejszych) i agregacji (łączenie kilku ramek w jedną) ramek, dzięki nim napastnik może atakować podatne sprzęty na kilkanaście sposobów.</p><p> Luki dzielą się na projektowe (słabe punkty wynikające z wad projektowych w standardach Wi-Fi) oraz implementacyjne (słabe punkty wynikające z błędów programistycznych w produktach Wi-Fi). Według badań każdy produkt Wi-Fi posiada co najmniej jedną wadę, a większość kilka wad. Podatności pozwalające na przeprowadzenie tego rodzaju ataków zostały znalezione jako skutek dogłębnej analizy standardu 802.11 i open source rozwiązań w dziedzinie. Znalezione luki odnoszą się wszystkich nowoczesnych protokołów bezpieczeństwa Wi-Fi, a nawet najnowszej specyfikacji WPA3 (Wi-Fi Protected Access 3), który wprowadził między innymi nowe standardy szyfrowania danych oraz ochronę przed atakami typu Brute Force (słownikowa próba złamania hasła) oraz oryginalnego protokołu bezpieczeństwa Wi-Fi o nazwie WEP (Wired Equivalent Privacy). WEP to standard szyfrowania danych używany w standardzie IEEE 802.11 i został wdrożony w 1999 roku.</p><p> Prowadzi nas to do przykrego wniosku, iż kilka z niedawno odkrytych wad projektowych istniały w sieciach Wi-Fi od momentu jego wprowadzenia na rynek, dokładnie w 1997 roku. Na szczęście wady projektowe są skomplikowane do wykorzystania, dlatego że wymagają one interakcji ze strony użytkownika albo są one możliwe do wykonania, tylko jeśli potencjalna ofiara posiada specyficzne niestandardowe ustawienia sieciowe na swoich urządzeniach. </p><p>Podsumowując, patrząc od strony praktycznej największym zagrożeniem są podatności wynikające z błędów programistycznych w produktach Wi-Fi, z uwagi na fakt, iż kilka z nich są naprawdę trywialne do nadużycia, o nich więcej w rozdziale “Rodzaje FragAttacks”. Na dzień dzisiejszy, większość tych podatności została naprawiona aktualizacjami oprogramowania urządzeń, ale znacząca ilość sprzętów pozostaje podatna. Te błędy pozwalają na szerokie spektrum wpływów na podatne urządzenia — od przechwytywania danych logowania do różnych stron poprzez otrzymanie dostępu do linii poleceń komputera ofiary. Wszystkie ataki typu FragAttacks polegają na wstrzykiwaniu do sieci Wi-Fi złośliwych ramek szkodzących ofierze na różne sposoby. Aby wykonać atak, przestępca musi znajdować się w zasięgu sieci Wi-Fi oraz być do niej podłączony, gdyż owe ataki dotyczą sieci bezprzewodowych. Co więcej, dużo ataków wymaga, aby haker był stroną Man In The Middle w trakcie ataku, czyli kontrolował cały ruch sieciowy pomiędzy routerem (bądź AP) a klientem, aby móc modyfikować ramki wysyłane od i do hosta.</p>

            <h2>Sposób działania</h2>

            <p>Jak wskazuje nazwa ataków (Fragmentation and Aggregation), ataki wykorzystują błędy i niedokładności w rozkładaniu ramek na mniejsze fragmenty również jak w odnawianiu ich z tych fragmentów na różne sposoby. To jest powiązane ze szczegółami implementacji fragmentów — często implementacje odnawiania ramek ignorują w tym informacje o fragmentach, które wydawały się mniej ważnymi w trakcie tworzenia programu — na przykład dane o tym, od którego urządzenia pochodził dany fragment albo flagi, oznaczające ilość fragmentów i podobne.</p><p> Dla wielu ataków potrzeba jest jednak pośredniczących metod ataku, żeby wykorzystać te niedoskonałości na własną korzyść, co zmienia podejście do nich z metody samodzielnej na metodę wspomagającą ze znaczącym potencjałem — szczególnie że często urządzenia, podatne na ten atak, mogą się stać zagrożeniem dla urządzeń, na których te niedoskonałości już zostały naprawione. Warto też zaznaczyć, że system operacyjny na urządzeniu docelowym najczęściej nie wpływa na efektywność przeprowadzenia ataków, z kilkoma wyjątkami, które zostały zaznaczone w oryginalnym artykule i o których możemy wspominać w ciągu opisu konkretnych rodzajów ataków. Najczęściej potrzeba będzie wcześniej zastosować nawiązanie kontaktu na jakikolwiek inny sposób do utworzenia połączenia w postaci Man In The Middle, które pozwoli na modyfikację ramek na sposoby umożliwiające te ataki. Przykładowo można to zrobić podszywając się pod sieć publiczną, np. Eduroam lub sieci w restauracjach, albo poprzez inżynierię socjalną. Takie podejścia miałyby sens dla wykorzystania w scenariuszu prawdziwym, również jak podejście drugie zostało zademonstrowane w oryginalnej prezentacji (mianowicie, wysłanie maila z obrazkiem, pobieranym ze złośliwego serwera). </p><p> W przypadku naszej pracy nie występuje potrzeby korzystania się z metod złośliwych, ponieważ urządzenia i środowiska są przez nas dobrane celowo, więc nawiązujemy połączenia wprost. Same ataki mają wspólny wektor działania, będący względnie małą modyfikacją ramek, mianowicie, numerów fragmentów lub innych danych w nagłówkach. Te zmiany są dostateczne do eksploatacji luk w zabezpieczeniach i pozwalają na osiągnięcie większych efektów niż samo przechwytywanie pakietów mogło by pozwolić.</p>

            <h2>Sposoby ochrony przed FragAttacks</h2>

            <p>Istniejące sposoby ochrony przed tymi atakami są podobne do sposobów ochrony przed prawie każdym innym atakiem. Pierwsze, co warto zrobić, to zaktualizować swoje urządzenia i sterowniki do nich jak najwcześniej. Aktualizacje sterowników w wielu wypadkach pomagają bronić się od ataków w prawie jakimkolwiek kontekście, ale szczególnie tutaj, ponieważ podatności, wykorzystywane w atakach, są bardzo stare, ale już zostały naprawione — przez co w tej pracy musieliśmy też znaleźć urządzenia, na których te ataki będą działać. Na urządzeniu, wypożyczonym od Politechniki Gdańskiej, testowanie wykazało sporą ilość podatności, natomiast na urządzeniu tego samego modelu, kupionym na potrzeby rozszerzonego testowania, było ich już mniej, co jednak zaburzało nam spójność testowania, więc musieliśmy zainstalować konkretne sterowniki. Przeciętny użytkownik może jednak powiązać tę akcję wyłącznie z zakupem nowego urządzenia (czy to routera, czy to karty sieciowej), ponieważ aktualizowanie sterowników na routerach może być utrudnione przez producenta (czy to przypadkowo, czy umyślnie), a akcja aktualizacji jako taka wciąż jest obarczona strachem, że coś się zepsuje.</p>

            <p>Następny sposób jest metodą, którą mają zastosowywać już właściciele stron internetowych. Chodzi tu o HSTS albo HTTP Strict Transport Security. Chociaż użytkownicy zawsze mają sprawdzać, czy faktycznie wykorzystują na stronie protokół HTTPS, a nie mniej bezpieczny HTTP, mechanizm HSTS wymusza na przeglądarce (po pierwszym odwiedzeniu strony, na zasadzie “Trust on first use”) użycie protokołu HTTPS za każdym razem, gdy odwiedza stronę, poprzez ustawienie odpowiednio pola nagłówka odpowiedzi HTTP “Strict-Transport-Security”. To głównie chroni przed niejednym rodzajem ataków typu Man In The Middle, których potrzebują do wykorzystania podatności w złośliwych celach niektóre opisane ataki.</p>

            <p>Poza tym, jak zawsze, zostaje baczność użytkownika, czyli obrona od tzw. social engineering, polegająca na znajomości z atakami, które potrzebują jednak jakiegokolwiek udziału użytkownika. Przykładowo, jeden z opisanych ataków przyrządza swój atak za pośrednictwem tworzenia ramki Wi-Fi na podstawie akcji pobrania obrazu czy pliku z e-maila, wysłanego napastnikiem. Chociaż sam w sobie ten plik nie jest niebezpieczny, ważne tu jest utworzenie fragmentu ramki, wysyłającej zapytanie do napastnika, wynikające z pobrania tego obrazku z serwera napastnika przez przeglądarkę w celu jego wyświetlenia — albo odwiedzenia strony napastnika, albo innych podobnych akcji. A więc, jak z każdym atakiem, użytkownikom warto przypominać sobie o rzeczach tak prostych, jak nie otwieranie maili z niewiadomych źródeł, niewchodzenie na podejrzane strony i szczególnie niepobieranie podejrzanych plików.</p>
        
        </div>
    </div>
</body>